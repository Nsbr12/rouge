<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Mini Rogue: Gold & Glory</title>
<style>
  body {
    background-color: #111;
    color: #0f0;
    font-family: monospace;
    padding: 20px;
  }
  #output {
    white-space: pre-wrap;
    border: 1px solid #0f0;
    padding: 10px;
    height: 600px;
    overflow-y: auto;
    background-color: #000;
  }
  button {
    margin-top: 10px;
    background-color: #222;
    color: #0f0;
    padding: 10px;
    border: 1px solid #0f0;
    cursor: pointer;
    margin-right: 5px;
  }
  input {
    padding: 5px;
    background-color: #000;
    color: #0f0;
    border: 1px solid #0f0;
  }
  #shop, #inventory {
    margin-top: 10px;
    padding: 10px;
    border: 1px dashed #0f0;
  }
</style>
</head>
<body>

<h1>Mini Rogue â€“ Gold & Glory</h1>

<div id="intro">
  <p>Enter your name, old warrior:</p>
  <input type="text" id="playerNameInput" placeholder="Your name here" />
  <button onclick="startGame()">Begin your journey</button>
</div>

<div id="game" style="display:none;">
  <div id="output"></div>
  <div id="controls">
    <button onclick="nextRoom()">Continue forward</button>
    <button onclick="toggleInventory()">Inventory</button>
    <button onclick="saveGame()">Save</button>
    <button onclick="loadGame()">Load</button>
  </div>
  <div id="battle" style="display:none;">
    <p>Choose your attack:</p>
    <button onclick="attack('Slash')">Slash</button>
    <button onclick="attack('Fire')">Fire</button>
    <button onclick="attack('Ice')">Ice</button>
    <button onclick="attack('Poison')">Poison</button>
    <button onclick="attack('Lightning')">Lightning</button>
  </div>
  <div id="shop" style="display:none;"></div>
  <div id="inventory" style="display:none;"></div>
</div>

<audio id="bgMusic" src="https://cdn.pixabay.com/audio/2022/03/15/audio_49f0d1d613.mp3" loop autoplay></audio>
<audio id="hitSound" src="https://cdn.pixabay.com/audio/2022/01/18/audio_49a4cc4f8b.mp3"></audio>
<audio id="buySound" src="https://cdn.pixabay.com/audio/2022/03/10/audio_f3c1348c29.mp3"></audio>

<script>
let playerName = "Tharion";
let playerHP = 25, maxHP = 25, weaponLevel = 1, armorLevel = 0, gold = 10;
let inventory = [];
let roomCount = 0, inBattle = false, currentEnemy = null, foundDagskar = false;
let gameCompleted = false;

const enemyTypes = [
  { name: "Young Goblin", hp: 10, weakness: "Slash" },
  { name: "Icy Wraith", hp: 12, weakness: "Fire" },
  { name: "Fire Beast", hp: 14, weakness: "Ice" },
  { name: "Rotten Warrior", hp: 11, weakness: "Poison" },
  { name: "Storm Bat", hp: 13, weakness: "Lightning" },
  { name: "Stone Golem", hp: 16, weakness: "Lightning" },
  { name: "Venom Spider", hp: 12, weakness: "Fire" },
  { name: "Dark Acolyte", hp: 18, weakness: "Slash" },
  { name: "Undead Knight", hp: 20, weakness: "Poison" }
];

const bosses = [
  { name: "Lord of Shadows", hp: 35, weakness: "Fire", boss: true },
  { name: "Frost Witch", hp: 40, weakness: "Slash", boss: true },
  { name: "Guardian of Flame", hp: 45, weakness: "Ice", boss: true }
];

function log(text) {
  const output = document.getElementById('output');
  output.innerText += '\n' + text;
  output.scrollTop = output.scrollHeight;
}

function playSound(id) {
  document.getElementById(id).play();
}

function startGame() {
  const nameInput = document.getElementById('playerNameInput').value.trim();
  if (nameInput !== "") playerName = nameInput;
  document.getElementById('intro').style.display = 'none';
  document.getElementById('game').style.display = 'block';
  log(`You are ${playerName}, returning to the cursed halls to reclaim your legend.`);
  updateStatus();
}

function updateStatus() {
  log(`HP: ${playerHP}/${maxHP} | Weapon: ${weaponLevel} | Armor: ${armorLevel} | Gold: ${gold} | Room: ${roomCount}`);
  if (foundDagskar && roomCount >= 100 && !gameCompleted) {
    gameCompleted = true;
    log("\nYou have cleared 100 rooms since finding the Sword of Dagskar. Your legend is complete. You are victorious!");
  }
}

function nextRoom() {
  if (inBattle || gameCompleted) return;
  roomCount++;
  log(`\n--- Room ${roomCount} ---`);
  const event = Math.random();
  if (event < 0.15) startShop();
  else if (event < 0.3) { log("Empty room. You rest a moment."); heal(3); }
  else if (event < 0.45) findItem();
  else startBattle();
  updateStatus();
}

function heal(amount) {
  playerHP = Math.min(playerHP + amount, maxHP);
  log(`+${amount} HP restored.`);
}

function findItem() {
  const item = ["Bomb", "Elixir", "Torch", "Sword of Dagskar"][Math.floor(Math.random()*4)];
  if (item === "Sword of Dagskar" && !foundDagskar) {
    foundDagskar = true;
    inventory.push(item);
    weaponLevel += 2;
    log("You have found the legendary Sword of Dagskar! You feel a powerful destiny awaken.");
  } else if (item !== "Sword of Dagskar") {
    inventory.push(item);
    log(`You found a ${item}.`);
  } else {
    log("You found nothing new.");
  }
}

function toggleInventory() {
  const inv = document.getElementById('inventory');
  inv.style.display = inv.style.display === 'none' ? 'block' : 'none';
  inv.innerHTML = `<p>Inventory: ${inventory.join(', ') || 'Empty'}</p>`;
}

function startBattle() {
  currentEnemy = roomCount % 15 === 0 ? {...bosses[(roomCount/15-1)%bosses.length]} : {...enemyTypes[Math.floor(Math.random()*enemyTypes.length)]};
  log(`Enemy appears: ${currentEnemy.name}. Weak to ${currentEnemy.weakness}`);
  inBattle = true;
  document.getElementById('battle').style.display = 'block';
  document.getElementById('controls').style.display = 'none';
}

function attack(type) {
  if (!inBattle) return;
  playSound('hitSound');
  let dmg = Math.floor(Math.random()*5)+2+weaponLevel;
  if (type === currentEnemy.weakness) { dmg += 4; log("It's super effective!"); }
  currentEnemy.hp -= dmg;
  log(`${type} deals ${dmg} damage. Enemy HP: ${Math.max(0, currentEnemy.hp)}`);
  if (currentEnemy.hp <= 0) {
    log(`You defeated ${currentEnemy.name}!`);
    gold += 10;
    if (currentEnemy.boss) { heal(10); weaponLevel++; armorLevel++; log("You feel stronger."); }
    inBattle = false;
    document.getElementById('battle').style.display = 'none';
    document.getElementById('controls').style.display = 'block';
    return;
  }
  let enemyDmg = Math.max(0, Math.floor(Math.random()*5)-armorLevel);
  playerHP -= enemyDmg;
  log(`${currentEnemy.name} hits back for ${enemyDmg} damage.`);
  if (playerHP <= 0) { log("You fall. The darkness wins."); inBattle = false; }
}

function startShop() {
  const shop = document.getElementById('shop');
  shop.innerHTML = `
    <p>Trader offers you goods:</p>
    <button onclick="buy('heal')">Potion (5 gold)</button>
    <button onclick="buy('weapon')">Weapon Upgrade (10 gold)</button>
    <button onclick="buy('armor')">Armor Upgrade (10 gold)</button>
    <button onclick="buy('bomb')">Buy Bomb (8 gold)</button>
    <button onclick="shopClose()">Leave</button>
  `;
  shop.style.display = 'block';
  document.getElementById('controls').style.display = 'none';
}

function buy(item) {
  playSound('buySound');
  if (item === 'heal' && gold >= 5) { heal(10); gold -= 5; }
  else if (item === 'weapon' && gold >= 10) { weaponLevel++; gold -= 10; }
  else if (item === 'armor' && gold >= 10) { armorLevel++; gold -= 10; }
  else if (item === 'bomb' && gold >= 8) { inventory.push("Bomb"); gold -= 8; }
  else log("Not enough gold.");
  updateStatus();
}

function shopClose() {
  document.getElementById('shop').style.display = 'none';
  document.getElementById('controls').style.display = 'block';
}

function saveGame() {
  const state = {playerName, playerHP, maxHP, weaponLevel, armorLevel, gold, inventory, roomCount, foundDagskar, gameCompleted};
  localStorage.setItem('rogueSave', JSON.stringify(state));
  log("Game saved.");
}

function loadGame() {
  const state = JSON.parse(localStorage.getItem('rogueSave'));
  if (!state) return log("No save found.");
  Object.assign(window, state);
  log("Game loaded.");
  updateStatus();
}
</script>
</body>
</html>

